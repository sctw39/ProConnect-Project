<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProConnect - Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0078D4',
                        primaryLight: '#50A0E4',
                        primaryDark: '#106EBE',
                        secondary: '#2BC48A',
                        accent: '#FFB900',
                        danger: '#E74C3C',
                        success: '#27AE60',
                        lightBg: '#FFFFFF',
                        lightSecondary: '#F8F9FA',
                        lightTertiary: '#E9ECEF',
                        textDark: '#212529',
                        textMedium: '#495057',
                        textLight: '#6C757D',
                        darkBg: '#181818',
                        darkSecondary: '#202020',
                        darkTertiary: '#2A2A2A'
                    }
                }
            }
        }
        
        // Check for dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>
    <style>
        /* Profile image styles */
        .profile-image-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto;
        }
        
        .profile-image {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .edit-icon {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 32px;
            height: 32px;
            background-color: #0078D4;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .edit-icon:hover {
            background-color: #106EBE;
        }
        
        /* Progress indicators */
        .profile-progress-track {
            height: 4px;
            background-color: #E9ECEF;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .profile-progress-bar {
            height: 100%;
            background-color: #0078D4;
            border-radius: 2px;
            transition: width 0.5s ease;
        }
        
        /* Section animations */
        .section-card {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .section-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* Skill badge styling */
        .skill-badge {
            display: inline-block;
            background-color: rgba(0, 120, 212, 0.1);
            color: #0078D4;
            border-radius: 50px;
            padding: 4px 10px;
            font-size: 0.75rem;
            margin-right: 6px;
            margin-bottom: 6px;
            white-space: nowrap;
        }
        
        /* Edit form animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s forwards;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        /* Empty state animation */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite ease-in-out;
        }
        
        /* Profile completion check animation */
        @keyframes checkmark {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .check-animation {
            animation: checkmark 0.5s forwards;
        }
        
        /* Dark mode support */
        .dark .bg-lightBg {
            background-color: #181818 !important;
        }
        
        .dark .bg-white, .dark .bg-lightSecondary {
            background-color: #202020 !important;
        }
        
        .dark .bg-lightTertiary {
            background-color: #2A2A2A !important;
        }
        
        .dark .text-textDark {
            color: #F8F9FA !important;
        }
        
        .dark .text-textMedium {
            color: #CED4DA !important;
        }
        
        .dark .border-gray-200 {
            border-color: #2A2A2A !important;
        }
        
        .dark .profile-progress-track {
            background-color: #333333;
        }
        
        .dark .skill-badge {
            background-color: rgba(0, 120, 212, 0.2);
        }
        
        .dark .profile-image {
            border-color: #202020;
        }
        
        /* Bottom navigation - dark mode */
        .dark .bottom-nav {
            background-color: #202020 !important;
            border-color: #2A2A2A !important;
        }
        
        .dark .nav-icon {
            color: #6C757D !important;
        }
        
        .dark .nav-icon.active {
            color: #0078D4 !important;
        }
    </style>
</head>
<body class="bg-lightBg text-textDark min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-md pb-20">
        <!-- App Header -->
        <header class="flex justify-between items-center mb-6">
            <h1 class="text-xl font-bold text-primary">Profile</h1>
            <div class="flex items-center">
                <button id="settingsBtn" class="text-primary mr-2">
                    <i class="fas fa-cog text-xl"></i>
                </button>
                <button id="shareProfileBtn" class="text-primary">
                    <i class="fas fa-share-alt text-xl"></i>
                </button>
            </div>
        </header>
        
        <!-- Authentication Check -->
        <div id="authCheck" class="hidden flex flex-col items-center justify-center py-8">
            <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-lock text-primary text-2xl"></i>
            </div>
            <h3 class="text-lg font-semibold mb-2">Sign in to view your profile</h3>
            <p class="text-textMedium mb-4 text-center">Please sign in or create an account to build your professional profile</p>
            <div class="flex space-x-4">
                <a href="login.html" class="bg-primary text-white px-6 py-2 rounded-lg">
                    Sign In
                </a>
                <a href="register.html" class="bg-lightTertiary text-textDark px-6 py-2 rounded-lg dark:bg-darkTertiary dark:text-gray-200">
                    Sign Up
                </a>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="hidden">
            <div class="flex justify-center mb-6">
                <div class="w-24 h-24 rounded-full bg-gray-200 animate-pulse"></div>
            </div>
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 shadow-sm mb-6 animate-pulse">
                <div class="h-6 bg-gray-200 dark:bg-darkTertiary rounded mb-3 w-3/4"></div>
                <div class="h-4 bg-gray-200 dark:bg-darkTertiary rounded mb-2 w-1/2"></div>
                <div class="h-4 bg-gray-200 dark:bg-darkTertiary rounded w-full"></div>
            </div>
            <div class="space-y-4">
                <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 shadow-sm animate-pulse">
                    <div class="h-5 bg-gray-200 dark:bg-darkTertiary rounded mb-3 w-1/3"></div>
                    <div class="h-4 bg-gray-200 dark:bg-darkTertiary rounded mb-2 w-full"></div>
                    <div class="h-4 bg-gray-200 dark:bg-darkTertiary rounded mb-2 w-full"></div>
                    <div class="h-4 bg-gray-200 dark:bg-darkTertiary rounded w-3/4"></div>
                </div>
                <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 shadow-sm animate-pulse">
                    <div class="h-5 bg-gray-200 dark:bg-darkTertiary rounded mb-3 w-1/3"></div>
                    <div class="h-4 bg-gray-200 dark:bg-darkTertiary rounded mb-2 w-full"></div>
                    <div class="h-4 bg-gray-200 dark:bg-darkTertiary rounded mb-2 w-full"></div>
                </div>
            </div>
        </div>

        <!-- Main Profile Content -->
        <div id="profileContent" class="hidden">
            <!-- Profile Header -->
            <div class="flex flex-col items-center mb-6">
                <div class="profile-image-container mb-3">
                    <img id="profileImage" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" alt="Profile photo" class="profile-image">
                    <div id="editProfileImageBtn" class="edit-icon">
                        <i class="fas fa-camera"></i>
                    </div>
                </div>
                <h2 id="profileName" class="text-xl font-bold mb-1">John Doe</h2>
                <p id="profileTitle" class="text-textMedium mb-2">Product Manager at TechCorp</p>
                <p id="profileLocation" class="text-textMedium text-sm mb-3"><i class="fas fa-map-marker-alt mr-1"></i>New York, NY</p>
                
                <!-- Profile Completeness -->
                <div class="w-full max-w-xs mb-2">
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-textMedium">Profile Completeness</span>
                        <span id="profileCompletionPercent" class="text-primary font-medium">70%</span>
                    </div>
                    <div class="profile-progress-track">
                        <div id="profileCompletionBar" class="profile-progress-bar" style="width: 70%"></div>
                    </div>
                </div>
                <p id="profileCompletionHint" class="text-xs text-textMedium mb-3">Add your skills to improve your profile</p>
                
                <!-- Quick Action Buttons -->
                <div class="flex space-x-3">
                    <button id="editProfileBtn" class="bg-primary text-white px-4 py-2 rounded-lg flex items-center">
                        <i class="fas fa-pen mr-2"></i> Edit Profile
                    </button>
                    <button id="viewAnalyticsBtn" class="bg-lightTertiary text-textDark px-4 py-2 rounded-lg dark:bg-darkTertiary dark:text-gray-200">
                        <i class="fas fa-chart-line mr-2"></i> Analytics
                    </button>
                </div>
            </div>
            
            <!-- About Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm section-card">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-medium">About</h3>
                    <button class="edit-section-btn text-primary" data-section="about">
                        <i class="fas fa-pen"></i>
                    </button>
                </div>
                <p id="aboutContent" class="text-textMedium text-sm">Experienced Product Manager with a passion for creating user-centered solutions. I specialize in agile methodologies and have a track record of launching successful products that deliver business value while meeting user needs.</p>
                
                <!-- About Edit Form (Hidden initially) -->
                <div id="aboutEditForm" class="hidden mt-3">
                    <textarea id="aboutTextarea" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none text-sm" rows="5" placeholder="Tell people about yourself, your experience, and what you're looking for"></textarea>
                    <div class="flex justify-end mt-2 space-x-2">
                        <button class="cancel-edit-btn px-3 py-1 text-sm text-textMedium">Cancel</button>
                        <button class="save-edit-btn px-3 py-1 bg-primary text-white text-sm rounded-lg" data-section="about">Save</button>
                    </div>
                </div>
            </div>
            
            <!-- Experience Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm section-card">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-medium">Experience</h3>
                    <button class="edit-section-btn text-primary" data-section="experience">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div id="experienceList">
                    <div class="mb-3 pb-3 border-b dark:border-darkTertiary">
                        <h4 class="font-medium">Product Manager</h4>
                        <p class="text-textMedium text-sm">TechCorp</p>
                        <p class="text-textLight text-xs">Jan 2020 - Present</p>
                    </div>
                    <div>
                        <h4 class="font-medium">Associate Product Manager</h4>
                        <p class="text-textMedium text-sm">StartupInc</p>
                        <p class="text-textLight text-xs">Mar 2018 - Dec 2019</p>
                    </div>
                </div>
                
                <!-- Experience Edit Form (Hidden initially) -->
                <div id="experienceEditForm" class="hidden mt-3 fade-in">
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium mb-1">Title</label>
                            <input type="text" id="expTitleInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="e.g. Product Manager">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Company</label>
                            <input type="text" id="expCompanyInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="e.g. TechCorp">
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="block text-sm font-medium mb-1">Start Date</label>
                                <input type="month" id="expStartInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">End Date</label>
                                <input type="month" id="expEndInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm">
                                <div class="flex items-center mt-1">
                                    <input type="checkbox" id="expCurrentInput" class="mr-1">
                                    <label for="expCurrentInput" class="text-xs">Current position</label>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Description</label>
                            <textarea id="expDescriptionInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm resize-none" rows="3" placeholder="Describe your responsibilities and achievements"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end mt-3 space-x-2">
                        <button class="cancel-edit-btn px-3 py-1 text-sm text-textMedium">Cancel</button>
                        <button class="save-edit-btn px-3 py-1 bg-primary text-white text-sm rounded-lg" data-section="experience">Save</button>
                    </div>
                </div>
            </div>
            
            <!-- Skills Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm section-card">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-medium">Skills</h3>
                    <button class="edit-section-btn text-primary" data-section="skills">
                        <i class="fas fa-pen"></i>
                    </button>
                </div>
                <div id="skillsList" class="flex flex-wrap">
                    <span class="skill-badge">Product Management</span>
                    <span class="skill-badge">User Research</span>
                    <span class="skill-badge">Agile</span>
                    <span class="skill-badge">Market Analysis</span>
                    <span class="skill-badge">Strategy</span>
                </div>
                
                <!-- Skills Edit Form (Hidden initially) -->
                <div id="skillsEditForm" class="hidden mt-3">
                    <input type="text" id="skillsInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="Add skills (comma separated)">
                    <p class="text-xs text-textLight mt-1">Enter skills separated by commas, e.g. "Product Management, Agile, UX Design"</p>
                    <div class="flex justify-end mt-2 space-x-2">
                        <button class="cancel-edit-btn px-3 py-1 text-sm text-textMedium">Cancel</button>
                        <button class="save-edit-btn px-3 py-1 bg-primary text-white text-sm rounded-lg" data-section="skills">Save</button>
                    </div>
                </div>
            </div>
            
            <!-- Education Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm section-card">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-medium">Education</h3>
                    <button class="edit-section-btn text-primary" data-section="education">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div id="educationList">
                    <div>
                        <h4 class="font-medium">Bachelor of Science in Computer Science</h4>
                        <p class="text-textMedium text-sm">University of Technology</p>
                        <p class="text-textLight text-xs">2014 - 2018</p>
                    </div>
                </div>
                
                <!-- Education Edit Form (Hidden initially) -->
                <div id="educationEditForm" class="hidden mt-3 fade-in">
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium mb-1">Degree</label>
                            <input type="text" id="eduDegreeInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="e.g. Bachelor of Science">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Field of Study</label>
                            <input type="text" id="eduFieldInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="e.g. Computer Science">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">School</label>
                            <input type="text" id="eduSchoolInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="e.g. University of Technology">
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="block text-sm font-medium mb-1">Start Year</label>
                                <input type="number" id="eduStartInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="e.g. 2014">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">End Year</label>
                                <input type="number" id="eduEndInput" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm" placeholder="e.g. 2018">
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-end mt-3 space-x-2">
                        <button class="cancel-edit-btn px-3 py-1 text-sm text-textMedium">Cancel</button>
                        <button class="save-edit-btn px-3 py-1 bg-primary text-white text-sm rounded-lg" data-section="education">Save</button>
                    </div>
                </div>
            </div>
            
            <!-- Connections Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm section-card">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-medium">Connections</h3>
                    <button id="viewAllConnectionsBtn" class="text-primary text-sm font-medium">
                        View All
                    </button>
                </div>
                <div id="connectionsList" class="grid grid-cols-2 gap-3">
                    <!-- Connections will be populated by JavaScript -->
                </div>
                
                <!-- Empty Connections State (Hidden initially) -->
                <div id="emptyConnectionsState" class="hidden py-4 text-center">
                    <div class="w-12 h-12 bg-lightTertiary dark:bg-darkTertiary rounded-full mx-auto flex items-center justify-center mb-2 pulse-animation">
                        <i class="fas fa-users text-textMedium"></i>
                    </div>
                    <p class="text-textMedium text-sm mb-2">No connections yet</p>
                    <a href="search.html" class="text-primary text-sm font-medium">Find professionals to connect with</a>
                </div>
            </div>
        </div>
        
        <!-- View Profile State (Hidden initially) -->
        <div id="viewProfileState" class="hidden">
            <!-- Profile Header -->
            <div class="flex flex-col items-center mb-6">
                <div class="profile-image-container mb-3">
                    <img id="viewProfileImage" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" alt="Profile photo" class="profile-image">
                </div>
                <h2 id="viewProfileName" class="text-xl font-bold mb-1">Sarah Chen</h2>
                <p id="viewProfileTitle" class="text-textMedium mb-2">Senior Developer at CodeLabs</p>
                <p id="viewProfileLocation" class="text-textMedium text-sm mb-4"><i class="fas fa-map-marker-alt mr-1"></i>San Francisco, CA</p>
                
                <!-- Connection Status -->
                <div id="connectionStatus" class="mb-3">
                    <div id="notConnectedState" class="hidden">
                        <button id="connectBtn" class="bg-primary text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-user-plus mr-2"></i> Connect
                        </button>
                    </div>
                    <div id="connectionPendingState" class="hidden">
                        <span class="bg-accent/10 text-accent px-3 py-1 rounded-full text-sm">Connection Pending</span>
                    </div>
                    <div id="connectedState" class="hidden">
                        <span class="bg-success/10 text-success px-3 py-1 rounded-full text-sm mr-2">Connected</span>
                        <button id="messageBtn" class="bg-primary text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-comment mr-2"></i> Message
                        </button>
                    </div>
                </div>
                
                <!-- Match Score -->
                <div class="bg-primary/10 rounded-lg p-3 mb-4 w-full max-w-xs">
                    <div class="flex justify-between items-center">
                        <span class="text-primary font-medium">Match Score</span>
                        <span id="matchScore" class="text-primary font-bold text-lg">78%</span>
                    </div>
                    <div class="profile-progress-track mt-1">
                        <div id="matchScoreBar" class="profile-progress-bar" style="width: 78%"></div>
                    </div>
                </div>
            </div>
            
            <!-- About Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm">
                <h3 class="font-medium mb-3">About</h3>
                <p id="viewAboutContent" class="text-textMedium text-sm">Full-stack developer with 7+ years of experience building scalable web applications. Passionate about clean code, performance optimization, and mentoring junior developers.</p>
            </div>
            
            <!-- Experience Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm">
                <h3 class="font-medium mb-3">Experience</h3>
                <div id="viewExperienceList">
                    <div class="mb-3 pb-3 border-b dark:border-darkTertiary">
                        <h4 class="font-medium">Senior Developer</h4>
                        <p class="text-textMedium text-sm">CodeLabs</p>
                        <p class="text-textLight text-xs">Mar 2020 - Present</p>
                    </div>
                    <div>
                        <h4 class="font-medium">Full-Stack Developer</h4>
                        <p class="text-textMedium text-sm">WebTech Solutions</p>
                        <p class="text-textLight text-xs">Jun 2016 - Feb 2020</p>
                    </div>
                </div>
            </div>
            
            <!-- Skills Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm">
                <h3 class="font-medium mb-3">Skills</h3>
                <div id="viewSkillsList" class="flex flex-wrap">
                    <!-- Skills with highlighting of matches -->
                </div>
            </div>
            
            <!-- Education Section -->
            <div class="bg-white dark:bg-darkSecondary rounded-lg p-4 mb-4 shadow-sm">
                <h3 class="font-medium mb-3">Education</h3>
                <div id="viewEducationList">
                    <div>
                        <h4 class="font-medium">Master of Computer Science</h4>
                        <p class="text-textMedium text-sm">Stanford University</p>
                        <p class="text-textLight text-xs">2014 - 2016</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div id="toastNotification" class="toast">
            Profile updated successfully
        </div>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 p-3 flex justify-around bg-white dark:bg-darkSecondary border-t dark:border-darkTertiary bottom-nav">
            <a href="index.html" class="flex flex-col items-center">
                <i class="fas fa-chart-line text-xl text-textLight dark:text-gray-500 nav-icon"></i>
                <span class="text-xs mt-1 text-textLight dark:text-gray-500">Analytics</span>
            </a>
            <a href="chat.html" class="flex flex-col items-center">
                <i class="fas fa-comments text-xl text-textLight dark:text-gray-500 nav-icon"></i>
                <span class="text-xs mt-1 text-textLight dark:text-gray-500">Chat</span>
            </a>
            <a href="search.html" class="flex flex-col items-center">
                <i class="fas fa-search text-xl text-textLight dark:text-gray-500 nav-icon"></i>
                <span class="text-xs mt-1 text-textLight dark:text-gray-500">Find</span>
            </a>
            <a href="profile.html" class="flex flex-col items-center">
                <i class="fas fa-user text-xl text-primary nav-icon active"></i>
                <span class="text-xs mt-1 text-primary">Profile</span>
            </a>
        </nav>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const authCheck = document.getElementById('authCheck');
            const loadingState = document.getElementById('loadingState');
            const profileContent = document.getElementById('profileContent');
            const viewProfileState = document.getElementById('viewProfileState');
            const editProfileBtn = document.getElementById('editProfileBtn');
            const viewAnalyticsBtn = document.getElementById('viewAnalyticsBtn');
            const settingsBtn = document.getElementById('settingsBtn');
            const shareProfileBtn = document.getElementById('shareProfileBtn');
            const editProfileImageBtn = document.getElementById('editProfileImageBtn');
            const toastNotification = document.getElementById('toastNotification');
            const profileCompletionBar = document.getElementById('profileCompletionBar');
            const profileCompletionPercent = document.getElementById('profileCompletionPercent');
            const profileCompletionHint = document.getElementById('profileCompletionHint');
            const viewAllConnectionsBtn = document.getElementById('viewAllConnectionsBtn');
            const connectionsList = document.getElementById('connectionsList');
            const emptyConnectionsState = document.getElementById('emptyConnectionsState');
            const connectBtn = document.getElementById('connectBtn');
            const messageBtn = document.getElementById('messageBtn');
            const notConnectedState = document.getElementById('notConnectedState');
            const connectionPendingState = document.getElementById('connectionPendingState');
            const connectedState = document.getElementById('connectedState');
            
            // Current state variables
            let currentUser = JSON.parse(localStorage.getItem('currentUser'));
            let isViewMode = false;
            let viewUserId = null;
            
            // Check URL for view parameter
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('view')) {
                viewUserId = urlParams.get('view');
                isViewMode = true;
            } else if (localStorage.getItem('viewProfileId')) {
                viewUserId = localStorage.getItem('viewProfileId');
                localStorage.removeItem('viewProfileId'); // Clear after use
                isViewMode = true;
            }
            
            // Initialize UI
            if (!currentUser) {
                // Show auth check message and hide profile content
                authCheck.classList.remove('hidden');
                profileContent.classList.add('hidden');
                viewProfileState.classList.add('hidden');
                loadingState.classList.add('hidden');
                return;
            } else {
                // Show loading initially
                authCheck.classList.add('hidden');
                loadingState.classList.remove('hidden');
                profileContent.classList.add('hidden');
                viewProfileState.classList.add('hidden');
                
                // Simulate loading delay
                setTimeout(() => {
                    loadingState.classList.add('hidden');
                    
                    if (isViewMode) {
                        // Load and show other user's profile
                        loadUserProfile(viewUserId);
                    } else {
                        // Load and show current user's profile
                        loadProfile();
                        profileContent.classList.remove('hidden');
                    }
                }, 1000);
            }
            
            // Load current user's profile
            function loadProfile() {
                // Set basic profile info
                document.getElementById('profileName').textContent = currentUser.fullName || "Your Name";
                
                // Set profile title (role at company)
                let title = "";
                if (currentUser.currentRole) {
                    title = currentUser.currentRole;
                    if (currentUser.company) {
                        title += " at " + currentUser.company;
                    }
                }
                document.getElementById('profileTitle').textContent = title;
                
                // Set profile location
                document.getElementById('profileLocation').textContent = currentUser.location || "Add your location";
                if (!currentUser.location) {
                    document.getElementById('profileLocation').innerHTML = '<i class="fas fa-map-marker-alt mr-1"></i>Add your location';
                } else {
                    document.getElementById('profileLocation').innerHTML = `<i class="fas fa-map-marker-alt mr-1"></i>${currentUser.location}`;
                }
                
                // Set profile image
                if (currentUser.profileImage) {
                    document.getElementById('profileImage').src = currentUser.profileImage;
                }
                
                // Set about content
                document.getElementById('aboutContent').textContent = currentUser.about || "Add a description about yourself";
                document.getElementById('aboutTextarea').value = currentUser.about || "";
                
                // Set skills
                let skillsHtml = "";
                if (currentUser.skills && currentUser.skills.length > 0) {
                    let skillsArray = currentUser.skills;
                    if (typeof skillsArray === 'string') {
                        skillsArray = skillsArray.split(',').map(s => s.trim());
                    }
                    
                    skillsHtml = skillsArray.map(skill => {
                        return `<span class="skill-badge">${skill}</span>`;
                    }).join('');
                    
                    document.getElementById('skillsInput').value = skillsArray.join(', ');
                }
                document.getElementById('skillsList').innerHTML = skillsHtml || '<span class="text-textLight text-sm">Add your skills</span>';
                
                // Set experience
                let experienceHtml = "";
                if (currentUser.experience && currentUser.experience.length > 0) {
                    experienceHtml = currentUser.experience.map((exp, index) => {
                        const isLast = index === currentUser.experience.length - 1;
                        return `
                            <div class="${!isLast ? 'mb-3 pb-3 border-b dark:border-darkTertiary' : ''}">
                                <h4 class="font-medium">${exp.title}</h4>
                                <p class="text-textMedium text-sm">${exp.company}</p>
                                <p class="text-textLight text-xs">${exp.startDate} - ${exp.endDate || 'Present'}</p>
                                ${exp.description ? `<p class="text-textMedium text-sm mt-1">${exp.description}</p>` : ''}
                            </div>
                        `;
                    }).join('');
                }
                document.getElementById('experienceList').innerHTML = experienceHtml || '<span class="text-textLight text-sm">Add your work experience</span>';
                
                // Set education
                let educationHtml = "";
                if (currentUser.education && currentUser.education.length > 0) {
                    educationHtml = currentUser.education.map((edu, index) => {
                        const isLast = index === currentUser.education.length - 1;
                        const degree = edu.degree + (edu.fieldOfStudy ? ' in ' + edu.fieldOfStudy : '');
                        return `
                            <div class="${!isLast ? 'mb-3 pb-3 border-b dark:border-darkTertiary' : ''}">
                                <h4 class="font-medium">${degree}</h4>
                                <p class="text-textMedium text-sm">${edu.school}</p>
                                <p class="text-textLight text-xs">${edu.startYear} - ${edu.endYear || 'Present'}</p>
                            </div>
                        `;
                    }).join('');
                }
                document.getElementById('educationList').innerHTML = educationHtml || '<span class="text-textLight text-sm">Add your education</span>';
                
                // Set connections
                loadConnections();
                
                // Calculate and update profile completion
                updateProfileCompletion();
            }
            
            // Load connections
            function loadConnections() {
                if (!currentUser.connections || currentUser.connections.length === 0) {
                    // Show empty state
                    connectionsList.classList.add('hidden');
                    emptyConnectionsState.classList.remove('hidden');
                    return;
                }
                
                // Hide empty state
                connectionsList.classList.remove('hidden');
                emptyConnectionsState.classList.add('hidden');
                
                // Limit to 4 connections
                const connectionsToShow = currentUser.connections.slice(0, 4);
                
                // Create HTML
                let connectionsHtml = connectionsToShow.map(conn => {
                    return `
                        <div class="flex flex-col items-center text-center">
                            <img src="${conn.profileImage || 'https://via.placeholder.com/50'}" class="w-12 h-12 rounded-full object-cover mb-1" alt="${conn.name}">
                            <p class="text-sm font-medium truncate w-full">${conn.name}</p>
                        </div>
                    `;
                }).join('');
                
                connectionsList.innerHTML = connectionsHtml;
            }
            
            // Load user profile
            function loadUserProfile(userId) {
                // Get user data
                let userData;
                
                try {
                    // Try different possible storage keys
                    userData = JSON.parse(localStorage.getItem(`user_${userId}`));
                    
                    if (!userData) {
                        userData = JSON.parse(localStorage.getItem(userId));
                    }
                    
                    if (!userData) {
                        // Try to find in sample users
                        const sampleUsers = JSON.parse(localStorage.getItem('sampleUsers')) || [];
                        userData = sampleUsers.find(u => u.id === userId);
                    }
                    
                    if (!userData) {
                        // Check if it's in the current user's connections
                        const connection = currentUser.connections.find(c => c.id === userId);
                        if (connection) {
                            userData = {
                                id: connection.id,
                                fullName: connection.name,
                                profileImage: connection.profileImage
                            };
                        }
                    }
                } catch (e) {
                    console.error("Error loading user data:", e);
                }
                
                if (!userData) {
                    // User not found, show error
                    showToast("User not found");
                    setTimeout(() => {
                        window.location.href = "profile.html";
                    }, 2000);
                    return;
                }
                
                // Set basic profile info
                document.getElementById('viewProfileName').textContent = userData.fullName || userData.name || "User";
                
                // Set profile title
                let title = "";
                if (userData.currentRole) {
                    title = userData.currentRole;
                    if (userData.company) {
                        title += " at " + userData.company;
                    }
                }
                document.getElementById('viewProfileTitle').textContent = title;
                
                // Set profile location
                if (!userData.location) {
                    document.getElementById('viewProfileLocation').classList.add('hidden');
                } else {
                    document.getElementById('viewProfileLocation').innerHTML = `<i class="fas fa-map-marker-alt mr-1"></i>${userData.location}`;
                }
                
                // Set profile image
                if (userData.profileImage) {
                    document.getElementById('viewProfileImage').src = userData.profileImage;
                }
                
                // Set about content
                document.getElementById('viewAboutContent').textContent = userData.about || "No information provided";
                
                // Set skills with highlighting of matches
                let skillsHtml = "";
                if (userData.skills && userData.skills.length > 0) {
                    let userSkillsArray = userData.skills;
                    if (typeof userSkillsArray === 'string') {
                        userSkillsArray = userSkillsArray.split(',').map(s => s.trim());
                    }
                    
                    // Get current user skills for comparison
                    let currentUserSkillsArray = [];
                    if (currentUser.skills) {
                        if (typeof currentUser.skills === 'string') {
                            currentUserSkillsArray = currentUser.skills.split(',').map(s => s.trim().toLowerCase());
                        } else if (Array.isArray(currentUser.skills)) {
                            currentUserSkillsArray = currentUser.skills.map(s => s.toLowerCase());
                        }
                    }
                    
                    skillsHtml = userSkillsArray.map(skill => {
                        const isMatch = currentUserSkillsArray.includes(skill.toLowerCase());
                        return `<span class="skill-badge ${isMatch ? 'bg-success/10 text-success' : ''}">${skill}${isMatch ? ' <i class="fas fa-check-circle text-xs"></i>' : ''}</span>`;
                    }).join('');
                }
                document.getElementById('viewSkillsList').innerHTML = skillsHtml || '<span class="text-textLight text-sm">No skills listed</span>';
                
                // Set experience
                let experienceHtml = "";
                if (userData.experience && userData.experience.length > 0) {
                    experienceHtml = userData.experience.map((exp, index) => {
                        const isLast = index === userData.experience.length - 1;
                        return `
                            <div class="${!isLast ? 'mb-3 pb-3 border-b dark:border-darkTertiary' : ''}">
                                <h4 class="font-medium">${exp.title}</h4>
                                <p class="text-textMedium text-sm">${exp.company}</p>
                                <p class="text-textLight text-xs">${exp.startDate} - ${exp.endDate || 'Present'}</p>
                                ${exp.description ? `<p class="text-textMedium text-sm mt-1">${exp.description}</p>` : ''}
                            </div>
                        `;
                    }).join('');
                }
                document.getElementById('viewExperienceList').innerHTML = experienceHtml || '<span class="text-textLight text-sm">No experience listed</span>';
                
                // Set education
                let educationHtml = "";
                if (userData.education && userData.education.length > 0) {
                    educationHtml = userData.education.map((edu, index) => {
                        const isLast = index === userData.education.length - 1;
                        const degree = edu.degree + (edu.fieldOfStudy ? ' in ' + edu.fieldOfStudy : '');
                        return `
                            <div class="${!isLast ? 'mb-3 pb-3 border-b dark:border-darkTertiary' : ''}">
                                <h4 class="font-medium">${degree}</h4>
                                <p class="text-textMedium text-sm">${edu.school}</p>
                                <p class="text-textLight text-xs">${edu.startYear} - ${edu.endYear || 'Present'}</p>
                            </div>
                        `;
                    }).join('');
                }
                document.getElementById('viewEducationList').innerHTML = educationHtml || '<span class="text-textLight text-sm">No education listed</span>';
                
                // Calculate and display match score
                calculateMatchScore(userData);
                
                // Check connection status and update UI
                updateConnectionStatus(userId);
                
                // Show view profile state
                viewProfileState.classList.remove('hidden');
            }
            
            // Calculate match score between current user and viewed user
            function calculateMatchScore(userData) {
                // Simple match algorithm (for demo purposes)
                let score = 50; // Base score
                
                // 1. Skills match (up to 25 points)
                const currentUserSkills = currentUser.skills || [];
                const viewedUserSkills = userData.skills || [];
                
                let currentUserSkillsArray = [];
                if (typeof currentUserSkills === 'string') {
                    currentUserSkillsArray = currentUserSkills.split(',').map(s => s.trim().toLowerCase());
                } else if (Array.isArray(currentUserSkills)) {
                    currentUserSkillsArray = currentUserSkills.map(s => s.toLowerCase());
                }
                
                let viewedUserSkillsArray = [];
                if (typeof viewedUserSkills === 'string') {
                    viewedUserSkillsArray = viewedUserSkills.split(',').map(s => s.trim().toLowerCase());
                } else if (Array.isArray(viewedUserSkills)) {
                    viewedUserSkillsArray = viewedUserSkills.map(s => s.toLowerCase());
                }
                
                if (currentUserSkillsArray.length > 0 && viewedUserSkillsArray.length > 0) {
                    const commonSkills = currentUserSkillsArray.filter(skill => viewedUserSkillsArray.includes(skill));
                    const skillMatchRatio = commonSkills.length / Math.max(currentUserSkillsArray.length, viewedUserSkillsArray.length);
                    
                    score += skillMatchRatio * 25;
                }
                
                // 2. Industry match (up to 15 points)
                if (currentUser.industry && userData.industry && 
                    currentUser.industry.toLowerCase() === userData.industry.toLowerCase()) {
                    score += 15;
                }
                
                // 3. Location match (up to 10 points)
                if (currentUser.location && userData.location) {
                    if (currentUser.location.toLowerCase() === userData.location.toLowerCase()) {
                        score += 10;
                    } else if (currentUser.location.toLowerCase().includes(userData.location.toLowerCase()) ||
                              userData.location.toLowerCase().includes(currentUser.location.toLowerCase())) {
                        score += 5;
                    }
                }
                
                // Update UI
                const matchScore = Math.round(score);
                document.getElementById('matchScore').textContent = matchScore + '%';
                document.getElementById('matchScoreBar').style.width = matchScore + '%';
            }
            
            // Update connection status
            function updateConnectionStatus(userId) {
                let isConnected = false;
                let isPending = false;
                
                // Check if they're already connected
                if (currentUser.connections) {
                    isConnected = currentUser.connections.some(conn => conn.id === userId);
                }
                
                // Check if connection is pending (in a real app, this would check a pending connections list)
                if (currentUser.pendingConnections) {
                    isPending = currentUser.pendingConnections.some(conn => conn.id === userId);
                }
                
                // Update UI based on connection status
                if (isConnected) {
                    notConnectedState.classList.add('hidden');
                    connectionPendingState.classList.add('hidden');
                    connectedState.classList.remove('hidden');
                } else if (isPending) {
                    notConnectedState.classList.add('hidden');
                    connectionPendingState.classList.remove('hidden');
                    connectedState.classList.add('hidden');
                } else {
                    notConnectedState.classList.remove('hidden');
                    connectionPendingState.classList.add('hidden');
                    connectedState.classList.add('hidden');
                }
            }
            
            // Calculate profile completion percentage
            function updateProfileCompletion() {
                let totalScore = 0;
                let hint = "";
                
                // Basic profile (30%)
                if (currentUser.fullName && currentUser.fullName.trim() !== "") totalScore += 5;
                if (currentUser.profileImage) totalScore += 5;
                if (currentUser.currentRole && currentUser.currentRole.trim() !== "") totalScore += 5;
                if (currentUser.company && currentUser.company.trim() !== "") totalScore += 5;
                if (currentUser.location && currentUser.location.trim() !== "") totalScore += 5;
                if (currentUser.industry && currentUser.industry.trim() !== "") totalScore += 5;
                
                // About (20%)
                if (currentUser.about) {
                    if (currentUser.about.length < 50) {
                        totalScore += 10;
                        if (!hint) hint = "Expand your about section for a better profile";
                    } else {
                        totalScore += 20;
                    }
                } else {
                    if (!hint) hint = "Add an about section to improve your profile";
                }
                
                // Skills (20%)
                if (currentUser.skills) {
                    let skillsCount = 0;
                    if (typeof currentUser.skills === 'string') {
                        skillsCount = currentUser.skills.split(',').filter(s => s.trim() !== "").length;
                    } else if (Array.isArray(currentUser.skills)) {
                        skillsCount = currentUser.skills.length;
                    }
                    
                    if (skillsCount === 0) {
                        if (!hint) hint = "Add your skills to improve your profile";
                    } else if (skillsCount < 3) {
                        totalScore += 10;
                        if (!hint) hint = "Add more skills to improve your profile";
                    } else {
                        totalScore += 20;
                    }
                } else {
                    if (!hint) hint = "Add your skills to improve your profile";
                }
                
                // Experience (20%)
                if (currentUser.experience && currentUser.experience.length > 0) {
                    totalScore += Math.min(currentUser.experience.length * 10, 20);
                } else {
                    if (!hint) hint = "Add your work experience to improve your profile";
                }
                
                // Education (10%)
                if (currentUser.education && currentUser.education.length > 0) {
                    totalScore += 10;
                } else {
                    if (!hint) hint = "Add your education to complete your profile";
                }
                
                // Update UI
                profileCompletionPercent.textContent = totalScore + '%';
                profileCompletionBar.style.width = totalScore + '%';
                
                // Update hint if profile is complete
                if (totalScore >= 90) {
                    hint = "Your profile is looking great!";
                }
                
                profileCompletionHint.textContent = hint;
            }
            
            // Show toast notification
            function showToast(message) {
                toastNotification.textContent = message;
                toastNotification.style.opacity = 1;
                
                setTimeout(() => {
                    toastNotification.style.opacity = 0;
                }, 3000);
            }
            
            // Event Listeners
            
            // Edit section buttons
            const editSectionBtns = document.querySelectorAll('.edit-section-btn');
            
            editSectionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    const formId = section + 'EditForm';
                    
                    // Show edit form
                    document.getElementById(formId).classList.remove('hidden');
                });
            });
            
            // Cancel edit buttons
            const cancelEditBtns = document.querySelectorAll('.cancel-edit-btn');
            
            cancelEditBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Find the parent form
                    const form = this.closest('[id$="EditForm"]');
                    form.classList.add('hidden');
                });
            });
            
            // Save edit buttons
            const saveEditBtns = document.querySelectorAll('.save-edit-btn');
            
            saveEditBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    
                    // Get form data and update profile
                    if (section === 'about') {
                        const aboutText = document.getElementById('aboutTextarea').value.trim();
                        currentUser.about = aboutText;
                        document.getElementById('aboutContent').textContent = aboutText;
                    } else if (section === 'skills') {
                        const skillsText = document.getElementById('skillsInput').value.trim();
                        const skillsArray = skillsText.split(',').map(s => s.trim()).filter(s => s !== "");
                        
                        currentUser.skills = skillsArray;
                        
                        // Update skills display
                        let skillsHtml = skillsArray.map(skill => {
                            return `<span class="skill-badge">${skill}</span>`;
                        }).join('');
                        
                        document.getElementById('skillsList').innerHTML = skillsHtml || '<span class="text-textLight text-sm">Add your skills</span>';
                    } else if (section === 'experience') {
                        // Get form values
                        const title = document.getElementById('expTitleInput').value.trim();
                        const company = document.getElementById('expCompanyInput').value.trim();
                        const startDate = document.getElementById('expStartInput').value;
                        const endDate = document.getElementById('expEndInput').value;
                        const isCurrent = document.getElementById('expCurrentInput').checked;
                        const description = document.getElementById('expDescriptionInput').value.trim();
                        
                        if (!title || !company || !startDate) {
                            showToast("Please fill in the required fields");
                            return;
                        }
                        
                        // Format dates
                        const formattedStartDate = startDate ? formatMonthYear(startDate) : '';
                        const formattedEndDate = isCurrent ? null : (endDate ? formatMonthYear(endDate) : '');
                        
                        // Create new experience object
                        const newExperience = {
                            title,
                            company,
                            startDate: formattedStartDate,
                            endDate: formattedEndDate,
                            description
                        };
                        
                        // Add to user profile
                        if (!currentUser.experience) {
                            currentUser.experience = [];
                        }
                        
                        currentUser.experience.unshift(newExperience); // Add to beginning of array
                        
                        // Update experience display
                        let experienceHtml = currentUser.experience.map((exp, index) => {
                            const isLast = index === currentUser.experience.length - 1;
                            return `
                                <div class="${!isLast ? 'mb-3 pb-3 border-b dark:border-darkTertiary' : ''}">
                                    <h4 class="font-medium">${exp.title}</h4>
                                    <p class="text-textMedium text-sm">${exp.company}</p>
                                    <p class="text-textLight text-xs">${exp.startDate} - ${exp.endDate || 'Present'}</p>
                                    ${exp.description ? `<p class="text-textMedium text-sm mt-1">${exp.description}</p>` : ''}
                                </div>
                            `;
                        }).join('');
                        
                        document.getElementById('experienceList').innerHTML = experienceHtml;
                        
                        // Reset form
                        document.getElementById('expTitleInput').value = '';
                        document.getElementById('expCompanyInput').value = '';
                        document.getElementById('expStartInput').value = '';
                        document.getElementById('expEndInput').value = '';
                        document.getElementById('expCurrentInput').checked = false;
                        document.getElementById('expDescriptionInput').value = '';
                        
                    } else if (section === 'education') {
                        // Get form values
                        const degree = document.getElementById('eduDegreeInput').value.trim();
                        const fieldOfStudy = document.getElementById('eduFieldInput').value.trim();
                        const school = document.getElementById('eduSchoolInput').value.trim();
                        const startYear = document.getElementById('eduStartInput').value.trim();
                        const endYear = document.getElementById('eduEndInput').value.trim();
                        
                        if (!degree || !school || !startYear) {
                            showToast("Please fill in the required fields");
                            return;
                        }
                        
                        // Create new education object
                        const newEducation = {
                            degree,
                            fieldOfStudy,
                            school,
                            startYear,
                            endYear
                        };
                        
                        // Add to user profile
                        if (!currentUser.education) {
                            currentUser.education = [];
                        }
                        
                        currentUser.education.unshift(newEducation); // Add to beginning of array
                        
                        // Update education display
                        let educationHtml = currentUser.education.map((edu, index) => {
                            const isLast = index === currentUser.education.length - 1;
                            const fullDegree = edu.degree + (edu.fieldOfStudy ? ' in ' + edu.fieldOfStudy : '');
                            return `
                                <div class="${!isLast ? 'mb-3 pb-3 border-b dark:border-darkTertiary' : ''}">
                                    <h4 class="font-medium">${fullDegree}</h4>
                                    <p class="text-textMedium text-sm">${edu.school}</p>
                                    <p class="text-textLight text-xs">${edu.startYear} - ${edu.endYear || 'Present'}</p>
                                </div>
                            `;
                        }).join('');
                        
                        document.getElementById('educationList').innerHTML = educationHtml;
                        
                        // Reset form
                        document.getElementById('eduDegreeInput').value = '';
                        document.getElementById('eduFieldInput').value = '';
                        document.getElementById('eduSchoolInput').value = '';
                        document.getElementById('eduStartInput').value = '';
                        document.getElementById('eduEndInput').value = '';
                    }
                    
                    // Save to localStorage
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    // Hide form
                    const form = this.closest('[id$="EditForm"]');
                    form.classList.add('hidden');
                    
                    // Update profile completion
                    updateProfileCompletion();
                    
                    // Show success message
                    showToast("Profile updated successfully");
                });
            });
            
            // Connect button
            if (connectBtn) {
                connectBtn.addEventListener('click', function() {
                    // Add to connections (in a real app this would be a connection request)
                    if (!currentUser.connections) {
                        currentUser.connections = [];
                    }
                    
                    // Get user data
                    let userData;
                    
                    try {
                        userData = JSON.parse(localStorage.getItem(`user_${viewUserId}`));
                        
                        if (!userData) {
                            userData = JSON.parse(localStorage.getItem(viewUserId));
                        }
                        
                        if (!userData) {
                            const sampleUsers = JSON.parse(localStorage.getItem('sampleUsers')) || [];
                            userData = sampleUsers.find(u => u.id === viewUserId);
                        }
                    } catch (e) {
                        console.error("Error loading user data:", e);
                    }
                    
                    if (!userData) return;
                    
                    // Add to connections
                    currentUser.connections.push({
                        id: viewUserId,
                        name: userData.fullName || userData.name,
                        timestamp: Date.now(),
                        profileImage: userData.profileImage
                    });
                    
                    // Save to localStorage
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    // Update UI
                    updateConnectionStatus(viewUserId);
                    
                    // Show success message
                    showToast("Connection added");
                });
            }
            
            // Message button
            if (messageBtn) {
                messageBtn.addEventListener('click', function() {
                    // Redirect to chat page
                    window.location.href = "chat.html";
                });
            }
            
            // View analytics button
            viewAnalyticsBtn.addEventListener('click', function() {
                window.location.href = "index.html";
            });
            
            // Format month and year
            function formatMonthYear(input) {
                const date = new Date(input);
                return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
            }
        });
    </script>
</body>
</html>
